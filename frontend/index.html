<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>BSC 2013</title>
  <link rel="stylesheet" href="css/normalize.css">
  <link rel="stylesheet" href="css/style.css">
  <link rel="stylesheet" href="css/bootstrap.min.css">
  <script src="js/libs/jquery-1.10.2.js"></script>
  <script src="js/libs/bootstrap.min.js"></script>
  <script src="js/libs/handlebars-1.1.2.js"></script>
  <script src="js/libs/ember-1.3.1.js"></script>
  <script src="js/libs/ember-data.js"></script>
</head>
<body>
  <script type="text/x-handlebars" data-template-name="bsc">
    <nav class="navbar navbar-default" role="navigation">
      <!-- Brand and toggle get grouped for better mobile display -->
      <div class="navbar-header">
	<button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
	  <span class="sr-only">Toggle navigation</span>
	  <span class="icon-bar"></span>
	  <span class="icon-bar"></span>
	  <span class="icon-bar"></span>
	</button>
	<a class="navbar-brand" href="#">BSC</a>
      </div>
      <!-- Collect the nav links, forms, and other content for toggling -->
      <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
	<ul class="nav navbar-nav">
	  <!--
	      <li class="active"><a href="#">Link</a></li>
	  <li><a href="#">Link</a></li>
	  -->
	  <li class="dropdown">
	    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Week {{currentWeek}} <b class="caret"></b></a>
	    <!-- TODO: need to fix the active selection, this doesn't really work -->
	    <ul class="dropdown-menu">
	      {{#each}}
	      <li>{{#link-to 'week' this tagName="li" href=false}}<a {{bind-attr href="view.href"}}>{{number}}</a>{{/link-to}}</li>
	      {{/each}}
	    </ul>
	  </li>
	</ul>
	<!--
	    <form class="navbar-form navbar-left" role="search">
	      <div class="form-group">
		<input type="text" class="form-control" placeholder="Search">
	      </div>
	      <button type="submit" class="btn btn-default">Submit</button>
	    </form>
	    -->
	<!--
	    <ul class="nav navbar-nav navbar-right">
	      <li><a href="#">Link</a></li>
	      <li class="dropdown">
		<a href="#" class="dropdown-toggle" data-toggle="dropdown">Dropdown <b class="caret"></b></a>
		<ul class="dropdown-menu">
		  <li><a href="#">Action</a></li>
		  <li><a href="#">Another action</a></li>
		  <li><a href="#">Something else here</a></li>
		  <li class="divider"></li>
		  <li><a href="#">Separated link</a></li>
		</ul>
	      </li>
	    </ul>
	    -->
      </div><!-- /.navbar-collapse -->
  </nav>

    {{outlet}}
  </script>
  
  <script type="text/x-handlebars" data-template-name="week">
    <h3>Week {{number}}</h3>
    
    <table class="table table-condensed">
      <thead>
	<tr>
	  <th>Away</th>
	  <th>Home</th>
	  <th>Line</th>
	  <th>Winner</th>
	  <th>Bet</th>
	</tr>
      </thead>
      <tfoot>
	<tr>
	  <td colspan="4" style="text-align: right">Total bet</td>
	  {{#each pointTotals}}
	  {{#if valid}}
	  <td>{{total}}</td>
	  {{else}}
	  <td class="danger">{{total}}</td>
	  {{/if}}
	  {{/each}}
	</tr>
      </tfoot>
      <tbody>
	{{#each matchup in matchups itemController="matchup"}}
	<tr>
	  <td>{{awayTeam.name}}</td>
	  <td>{{homeTeam.name}}</td>
	  <td>{{#if homeIsFavored}} {{line}} {{else}} +{{line}} {{/if}}</td>

	  {{#each orderedBets itemController="bet"}}
	  <td {{bind-attr style=winnerColors}}>
	    {{#if controllers.week.canEdit}}
	    {{view Ember.Select content=matchup.teams selection=winner prompt="Choose a winner"
	      optionValuePath="content.id" optionLabelPath="content.name"}}
	    {{else}}
	    {{winner.name}}
	    {{/if}}
	  </td>
	  <td {{bind-attr style=winnerColors}}>
	    {{#if controllers.week.canEdit}} {{input value=points}} {{else}} {{points}} {{/if}}
	  </td>
	  {{/each}}
	</tr>
	{{/each}}
      </tbody>
    </table>
  </script>

  <script src="js/app.js"></script>
  <!-- to activate the test runner, add the "?test" query string parameter -->
  <script src="tests/runner.js"></script>
</body>
</html>
